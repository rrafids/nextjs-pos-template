(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6840:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return r(6814)}])},1761:function(t,e,r){"use strict";r.d(e,{Ho:function(){return c},QL:function(){return l},aC:function(){return a}});var u=r(5893),n=r(7294),o=r(1163);let s=(0,n.createContext)(void 0),i="pos-ui/auth-token";function c(t){let{children:e}=t,[r,c]=(0,n.useState)(null),[a,l]=(0,n.useState)(!1),d=(0,o.useRouter)();(0,n.useEffect)(()=>{let t=window.localStorage.getItem(i);t&&c(t),l(!0)},[]);let f=t=>{let e=t&&t.trim().length>0?"token:".concat(t.trim()):"token:guest";c(e),window.localStorage.setItem(i,e),d.push("/products").catch(()=>{})},p=()=>{c(null),window.localStorage.removeItem(i),d.push("/login").catch(()=>{})},m=(0,n.useMemo)(()=>({token:r,authReady:a,login:f,logout:p}),[r,a]);return(0,u.jsx)(s.Provider,{value:m,children:e})}function a(){let t=(0,n.useContext)(s);if(!t)throw Error("useAuth must be used within AuthProvider");return t}function l(){let{token:t,authReady:e}=a(),r=(0,o.useRouter)();return(0,n.useEffect)(()=>{e&&!t&&r.push("/login").catch(()=>{})},[e,t,r]),{token:t,authReady:e}}},7829:function(t,e,r){"use strict";let u;r.d(e,{_:function(){return p},m:function(){return m}});var n=r(5893),o=r(7294),s={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let i=new Uint8Array(16),c=[];for(let t=0;t<256;++t)c.push((t+256).toString(16).slice(1));var a=function(t,e,r){if(s.randomUUID&&!e&&!t)return s.randomUUID();let n=(t=t||{}).random||(t.rng||function(){if(!u&&!(u="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return u(i)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=n[t];return e}return function(t,e=0){return c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]}(n)};let l="pos-ui/inventory",d={categories:[],subcategories:[],products:[],sales:[],purchases:[]},f=(0,o.createContext)(void 0);function p(t){let{children:e}=t,[r,u]=(0,o.useState)(d),[s,i]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let t=window.localStorage.getItem(l);if(t)try{var e,r,n,o,s;let i=JSON.parse(t);u({categories:null!==(e=i.categories)&&void 0!==e?e:d.categories,subcategories:null!==(r=i.subcategories)&&void 0!==r?r:d.subcategories,products:null!==(n=i.products)&&void 0!==n?n:d.products,sales:null!==(o=i.sales)&&void 0!==o?o:d.sales,purchases:null!==(s=i.purchases)&&void 0!==s?s:d.purchases})}catch(t){}i(!0)},[]),(0,o.useEffect)(()=>{s&&window.localStorage.setItem(l,JSON.stringify(r))},[r,s]);let c=t=>{let e=t.trim();if(!e||r.categories.find(t=>t.name.toLowerCase()===e.toLowerCase()))return null;let n={id:a(),name:e};return u(t=>({...t,categories:[...t.categories,n]})),n},p=(t,e)=>{let n=t.trim();if(!n||!e||r.subcategories.find(t=>t.name.toLowerCase()===n.toLowerCase()&&t.categoryId===e))return null;let o={id:a(),name:n,categoryId:e};return u(t=>({...t,subcategories:[...t.subcategories,o]})),o},m=t=>{var e;let r=t.name.trim(),n=t.sku.trim();if(!r||!n)return null;let o=Number(t.price),s=Number(t.stock);if(Number.isNaN(o)||Number.isNaN(s))return null;let i=null!==(e=t.id)&&void 0!==e?e:a(),c={...t,id:i,name:r,sku:n,price:o,stock:Math.max(0,Math.floor(s)),subcategoryIds:t.subcategoryIds};return u(t=>{let e=t.products.findIndex(t=>t.id===i);if(e>=0){let r=[...t.products];return r[e]=c,{...t,products:r}}return{...t,products:[...t.products,c]}}),{...c}},g=(t,e)=>{if(e<=0)return{success:!1,message:"Quantity must be positive"};let n=r.products.find(e=>e.id===t);if(!n)return{success:!1,message:"Product not found"};let o=Math.min(e,n.stock);if(o<=0)return{success:!1,message:"No stock available"};let s=Number((n.price*o).toFixed(2)),i={id:a(),productId:t,quantity:o,total:s,timestamp:new Date().toISOString()};return u(e=>{var r;return{...e,products:e.products.map(e=>e.id===t?{...e,stock:Math.max(0,e.stock-o)}:e),sales:[i,...null!==(r=e.sales)&&void 0!==r?r:[]]}}),{success:!0}},h=(t,e)=>{if(e<=0)return{success:!1,message:"Quantity must be positive"};if(!r.products.find(e=>e.id===t))return{success:!1,message:"Product not found"};let n={id:a(),productId:t,quantity:e,timestamp:new Date().toISOString()};return u(r=>{var u;return{...r,products:r.products.map(r=>r.id===t?{...r,stock:r.stock+e}:r),purchases:[n,...null!==(u=r.purchases)&&void 0!==u?u:[]]}}),{success:!0}},v=(0,o.useMemo)(()=>({...r,addCategory:c,addSubcategory:p,upsertProduct:m,sell:g,purchase:h}),[r]);return(0,n.jsx)(f.Provider,{value:v,children:s?e:null})}function m(){let t=(0,o.useContext)(f);if(!t)throw Error("useInventory must be used within InventoryProvider");return t}},6814:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return s}});var u=r(5893),n=r(1761),o=r(7829);function s(t){let{Component:e,pageProps:r}=t;return(0,u.jsx)(n.Ho,{children:(0,u.jsx)(o._,{children:(0,u.jsx)(e,{...r})})})}r(9311)},9311:function(){},1163:function(t,e,r){t.exports=r(9090)}},function(t){var e=function(e){return t(t.s=e)};t.O(0,[774,179],function(){return e(6840),e(9090)}),_N_E=t.O()}]);