(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[345],{4918:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/products",function(){return s(7029)}])},4823:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var l=s(5893),a=s(1664),i=s.n(a),n=s(1163),r=s(1761);let d=[{href:"/products",label:"Products"},{href:"/categories",label:"Categories"},{href:"/pos",label:"POS"},{href:"/history/inbound",label:"Inbound History"},{href:"/history/outbound",label:"Outbound History"}];function c(){let{logout:e}=(0,r.aC)(),t=(0,n.useRouter)(),s=e=>t.pathname===e||t.pathname.startsWith("".concat(e,"/"));return(0,l.jsx)("aside",{className:"w-full bg-slate-950 text-slate-100 lg:sticky lg:top-0 lg:h-screen lg:w-64",children:(0,l.jsxs)("div",{className:"flex flex-col border-b border-slate-800 bg-gradient-to-b from-slate-950 to-slate-900 lg:h-full",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 border-b border-slate-800 px-4 py-4",children:[(0,l.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-indigo-500 text-base font-semibold text-white shadow-lg shadow-indigo-500/30",children:"POS"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(i(),{href:"/products",className:"text-lg font-semibold text-white",children:"Cuslabs POS"}),(0,l.jsx)("p",{className:"text-xs text-slate-400",children:"Cuslabs POS"})]})]}),(0,l.jsx)("nav",{className:"flex-1 space-y-1 px-3 py-4 text-sm",children:d.map(e=>(0,l.jsx)(i(),{href:e.href,className:["flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition",s(e.href)?"bg-indigo-500/20 text-white ring-1 ring-indigo-400/70":"text-slate-100 hover:bg-slate-800 hover:text-white"].join(" "),children:e.label},e.href))}),(0,l.jsx)("div",{className:"border-t border-slate-800 px-3 py-4",children:(0,l.jsx)("button",{className:"w-full rounded-lg bg-slate-800 px-3 py-2 text-center text-slate-100 transition hover:bg-slate-700",onClick:e,type:"button",children:"Logout"})})]})})}function o(e){let{children:t}=e;return(0,l.jsx)("div",{className:"min-h-screen bg-slate-100",children:(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,l.jsx)(c,{}),(0,l.jsx)("main",{className:"flex-1 px-4 py-6 lg:px-10",children:(0,l.jsx)("div",{className:"mx-auto w-full max-w-6xl",children:t})})]})})}},3420:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var l=s(5893),a=s(7294),i=s(1163),n=s(7829);function r(e){var t,s,r,d,c,o,x;let{product:u,onSuccess:m}=e,{categories:h,subcategories:p,upsertProduct:g}=(0,n.m)(),b=(0,i.useRouter)(),[f,j]=(0,a.useState)(null!==(r=null==u?void 0:u.name)&&void 0!==r?r:""),[v,N]=(0,a.useState)(null!==(d=null==u?void 0:u.sku)&&void 0!==d?d:""),[y,w]=(0,a.useState)(null!==(c=null==u?void 0:null===(t=u.price)||void 0===t?void 0:t.toString())&&void 0!==c?c:"0"),[k,S]=(0,a.useState)(null!==(o=null==u?void 0:null===(s=u.stock)||void 0===s?void 0:s.toString())&&void 0!==o?o:"0"),[C,P]=(0,a.useState)(null!==(x=null==u?void 0:u.subcategoryIds)&&void 0!==x?x:[]),[_,O]=(0,a.useState)(null),E=(0,a.useMemo)(()=>h.map(e=>({category:e,subcategories:p.filter(t=>t.categoryId===e.id)})),[h,p]),I=e=>{P(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,l.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),O(null),!f.trim())return O("Name is required");if(!v.trim())return O("SKU is required");let t=Number(y);if(Number.isNaN(t)||t<0)return O("Price must be 0 or more");let s=Number(k);if(Number.isNaN(s)||s<0)return O("Stock must be 0 or more");if(!g({id:null==u?void 0:u.id,name:f,sku:v,price:t,stock:s,subcategoryIds:C})){O("Could not save product");return}m?m():b.push("/products").catch(()=>{})},className:"card space-y-5",children:[(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Name"}),(0,l.jsx)("input",{value:f,onChange:e=>j(e.target.value),required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"SKU"}),(0,l.jsx)("input",{value:v,onChange:e=>N(e.target.value),required:!0})]})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Price"}),(0,l.jsx)("input",{type:"number",min:"0",step:"0.01",value:y,onChange:e=>w(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Stock"}),(0,l.jsx)("input",{type:"number",min:"0",step:"1",value:k,onChange:e=>S(e.target.value)})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"mb-2 block text-sm font-medium text-slate-700",children:"Categories / Subcategories"}),0===E.length?(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Add a category first."}):(0,l.jsx)("div",{className:"grid gap-3 md:grid-cols-2",children:E.map(e=>(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3",children:[(0,l.jsx)("p",{className:"mb-2 font-semibold text-slate-800",children:e.category.name}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.subcategories.map(e=>(0,l.jsxs)("label",{className:"flex items-center gap-2 rounded bg-white px-2 py-1 text-sm shadow-sm ring-1 ring-slate-200",children:[(0,l.jsx)("input",{type:"checkbox",checked:C.includes(e.id),onChange:()=>I(e.id)}),e.name]},e.id)),0===e.subcategories.length&&(0,l.jsx)("span",{className:"text-xs text-slate-500",children:"No subcategories yet"})]})]},e.category.id))})]}),_&&(0,l.jsx)("p",{className:"text-sm text-rose-600",children:_}),(0,l.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,l.jsx)("button",{type:"button",className:"rounded-lg border border-slate-300 px-4 py-2 text-slate-700 hover:bg-slate-100",onClick:()=>{m?m():b.push("/products").catch(()=>{})},children:"Cancel"}),(0,l.jsx)("button",{type:"submit",className:"rounded-lg bg-indigo-600 px-4 py-2 text-white shadow-sm transition hover:bg-indigo-700",children:u?"Update Product":"Create Product"})]})]})}},7029:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var l=s(5893),a=s(7294),i=s(4823),n=s(1664),r=s.n(n);function d(e){let{products:t,categories:s,subcategories:a}=e,i=new Map(s.map(e=>[e.id,e.name])),n=new Map(a.map(e=>[e.id,e]));return(0,l.jsx)("div",{className:"card overflow-hidden",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[(0,l.jsx)("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-slate-700",children:"Name"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-slate-700",children:"SKU"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-slate-700",children:"Price"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-slate-700",children:"Stock"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-slate-700",children:"Categories"}),(0,l.jsx)("th",{className:"px-4 py-3"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-100",children:0===t.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{className:"px-4 py-4 text-center text-slate-500",colSpan:6,children:"No products yet."})}):t.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,l.jsx)("td",{className:"px-4 py-3 font-medium text-slate-900",children:e.name}),(0,l.jsx)("td",{className:"px-4 py-3 text-slate-700",children:e.sku}),(0,l.jsxs)("td",{className:"px-4 py-3 text-slate-700",children:["Rp ",e.price.toFixed(2)]}),(0,l.jsx)("td",{className:"px-4 py-3 text-slate-700",children:e.stock}),(0,l.jsx)("td",{className:"px-4 py-3 text-slate-700",children:(0,l.jsx)("div",{className:"flex flex-wrap gap-1",children:e.subcategoryIds.map(e=>{var t;let s=n.get(e);if(!s)return null;let a=null!==(t=i.get(s.categoryId))&&void 0!==t?t:"Unassigned";return(0,l.jsxs)("span",{className:"rounded bg-indigo-50 px-2 py-1 text-xs text-indigo-700 ring-1 ring-indigo-100",children:[a," / ",s.name]},e)})})}),(0,l.jsx)("td",{className:"px-4 py-3 text-right",children:(0,l.jsx)(r(),{href:"/products/".concat(e.id),className:"text-indigo-600 hover:underline",children:"Edit"})})]},e.id))})]})})}var c=s(7829);function o(){var e,t;let{products:s,purchase:i}=(0,c.m)(),[n,r]=(0,a.useState)(null!==(t=null===(e=s[0])||void 0===e?void 0:e.id)&&void 0!==t?t:""),[d,o]=(0,a.useState)("1"),[x,u]=(0,a.useState)(null);return(0,l.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),u(null),!n){u("Select a product.");return}let t=i(n,Number(d));if(t.success)u("Stock increased");else{var s;u(null!==(s=t.message)&&void 0!==s?s:"Purchase failed")}},className:"card space-y-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Purchase"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Product"}),(0,l.jsxs)("select",{value:n,onChange:e=>r(e.target.value),children:[(0,l.jsx)("option",{value:"",children:"Select a product"}),s.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.name," (Stock: ",e.stock,")"]},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Quantity"}),(0,l.jsx)("input",{type:"number",min:"1",step:"1",value:d,onChange:e=>o(e.target.value)})]}),x&&(0,l.jsx)("p",{className:"text-sm text-indigo-700",children:x}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)("button",{type:"submit",className:"rounded-lg bg-indigo-600 px-4 py-2 text-white shadow-sm hover:bg-indigo-700",children:"Add Stock"})})]})}var x=s(3420),u=s(1761);function m(){let{authReady:e,token:t}=(0,u.QL)(),{products:s,categories:n,subcategories:r}=(0,c.m)(),[m,h]=(0,a.useState)(!1);return e&&t?(0,l.jsxs)(i.Z,{children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"page-title",children:"Products"}),(0,l.jsx)("p",{className:"page-subtitle",children:"Manage your products, categories, and stock."})]}),(0,l.jsx)("button",{className:"rounded-lg bg-indigo-600 px-4 py-2 text-white shadow-sm transition hover:bg-indigo-700",onClick:()=>h(!0),children:"+ New Product"})]}),(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,l.jsx)("div",{className:"lg:col-span-2",children:(0,l.jsx)(d,{products:s,categories:n,subcategories:r})}),(0,l.jsx)(o,{})]}),m&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>h(!1),children:(0,l.jsxs)("div",{className:"card w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"New Product"}),(0,l.jsx)("button",{className:"text-slate-500 hover:text-slate-700",onClick:()=>h(!1),type:"button",children:"âœ•"})]}),(0,l.jsx)(x.Z,{onSuccess:()=>h(!1)})]})})]}):null}}},function(e){e.O(0,[664,888,774,179],function(){return e(e.s=4918)}),_N_E=e.O()}]);